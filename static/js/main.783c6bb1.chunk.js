(this["webpackJsonpguess-the-song"]=this["webpackJsonpguess-the-song"]||[]).push([[0],{15:function(e,t,n){e.exports=n(24)},20:function(e,t,n){},24:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(10),o=n.n(c),i=(n(20),n(1)),u=n(2);function l(){var e=Object(i.a)(["\n      margin-bottom: 20px;\n      text-align: center;\n    "]);return l=function(){return e},e}function s(){var e=Object(i.a)(["\n      margin-top: 60px;\n    "]);return s=function(){return e},e}function f(){var e=Object(i.a)(["\n  font-family: 'Special Elite', cursive;\n  color: var(--orange-color);\n  font-size: ",";\n  font-weight: bold;\n\n  ",";\n\n  ","\n"]);return f=function(){return e},e}var d=u.b.h1(f(),(function(e){return e.small?"26px":"82px"}),(function(e){return!e.small&&Object(u.a)(s())}),(function(e){return e.small&&Object(u.a)(l())})),p=function(e){var t=e.small;return a.a.createElement(d,{small:t},"Guess the Song")};function b(){var e=Object(i.a)(["\n      display: block;\n      width: 100%;\n    "]);return b=function(){return e},e}function m(){var e=Object(i.a)(["\n          font-size: 20px;\n          padding: 12px 20px;\n        "]);return m=function(){return e},e}function g(){var e=Object(i.a)(["\n          font-size: 30px;\n          padding: 20px;\n        "]);return g=function(){return e},e}function v(){var e=Object(i.a)(["\n          font-size: 12px;\n          padding: 10px;\n        "]);return v=function(){return e},e}function h(){var e=Object(i.a)(["\n  border-style: solid;\n  border-width: 1px;\n  text-decoration: none;\n  text-align: center;\n  border-radius: 5px;\n  background: var(--green-color);\n  border-color: var(--green-dark-color);\n  color: #fff;\n\n  ","\n\n  ","\n"]);return h=function(){return e},e}var j,O=u.b.button(h(),(function(e){switch(e.size){case"sm":return Object(u.a)(v());case"lg":return Object(u.a)(g());default:return Object(u.a)(m())}}),(function(e){return e.block&&Object(u.a)(b())})),E=n(3);function y(){var e=Object(i.a)(["\n  background: var(--yellow-color);\n  height: 100%;\n"]);return y=function(){return e},e}function x(){var e=Object(i.a)(["\n  height: 15px;\n  background: #ccc;\n  border: 1px solid #444;\n  border-radius: 10px;\n  overflow: hidden;\n  margin-bottom: 40px;\n"]);return x=function(){return e},e}var k=u.b.div(x()),w=u.b.div(y()),T=function(e){var t=e.src,n=e.total,c=Object(r.useState)(0),o=Object(E.a)(c,2),i=o[0],u=o[1],l=Object(r.useRef)(null);return Object(r.useEffect)((function(){u(0)}),[t]),Object(r.useEffect)((function(){i===n&&(l.current&&l.current.pause(),j&&clearInterval(j))}),[i,n]),Object(r.useEffect)((function(){j=setInterval((function(){var e;(null===(e=l.current)||void 0===e?void 0:e.currentTime)&&u(Math.ceil(l.current.currentTime))}),10)}),[t]),a.a.createElement(a.a.Fragment,null,a.a.createElement(k,null,a.a.createElement(w,{style:{width:"".concat(i/n*100,"%")}})),a.a.createElement("audio",{ref:l,src:t,autoPlay:!0}))},S=function(){var e=Object(r.useState)(""),t=Object(E.a)(e,2),n=t[0],a=t[1],c="gts-spotify-token";Object(r.useEffect)((function(){var e=o();e&&a(e)}),[]);var o=function(){return localStorage.getItem(c)};return{token:n,actions:{readToken:o,saveToken:function(e){localStorage.setItem(c,e),a(e)}}}},I=function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.random()*(t-e)+e},_=function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e))+e},C=function(e){return e.reduce((function(e,t){var n=Object(E.a)(t,2),r=n[0],a=n[1];return e?"".concat(e,"&").concat(r,"=").concat(a):"".concat(r,"=").concat(a)}),"")},M=["user-top-read"],N=function(){return function(){var e=[["client_id","d9d505e880594b7ca174cf7feeb525ea"],["redirect_uri","https://hermesnetto.github.io/guess-the-song/"],["scope",M.join("%20")],["response_type","token"],["show_dialog","true"]],t=C(e);window.location.href="".concat("https://accounts.spotify.com/authorize","?").concat(t)}},G=n(4),P={genres:[],difficulty:"15",gameState:"INIT",points:0},z=function(e){return"SWITCH_GAME_STATE"===e.type},A=function(e){return"SET_GENRES"===e.type},F=function(e){return"SET_DIFFICULTY"===e.type},R=function(e){return"INCREMENT_POINTS"===e.type},W=function(e){return"CLEAR_POINTS"===e.type},L=function(e){return{type:"SWITCH_GAME_STATE",payload:{nextState:e}}},U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P,t=arguments.length>1?arguments[1]:void 0;return z(t)?Object(G.a)({},e,{gameState:t.payload.nextState}):A(t)?Object(G.a)({},e,{genres:t.payload.genres}):F(t)?Object(G.a)({},e,{difficulty:t.payload.difficulty}):R(t)?Object(G.a)({},e,{points:e.points+1}):W(t)?Object(G.a)({},e,{points:0}):e},H=Object(r.createContext)({}),Y=function(e){var t=e.children,n=Object(r.useReducer)(U,P),c=Object(E.a)(n,2),o=c[0],i=c[1];return a.a.createElement(H.Provider,{value:{state:o,dispatch:i}},t)};function B(){var e=Object(i.a)(["\n      color: var(--green-color);\n    "]);return B=function(){return e},e}function D(){var e=Object(i.a)(["\n      color: var(--red-color);\n    "]);return D=function(){return e},e}function J(){var e=Object(i.a)(["\n      color: var(--green-color);\n    "]);return J=function(){return e},e}function $(){var e=Object(i.a)(["\n  display: block;\n  padding: 0;\n  border: 0;\n  font-family: sans-serif;\n  background: transparent;\n\n  ","\n  \n  ","\n\n  ","\n\n  &:disabled:hover {\n    cursor: not-allowed;\n  }\n"]);return $=function(){return e},e}function q(){var e=Object(i.a)(["\n  font-size: 16px;\n  font-weight: bold;\n"]);return q=function(){return e},e}function K(){var e=Object(i.a)(["\n  width: 100%;\n"]);return K=function(){return e},e}function Q(){var e=Object(i.a)(["\n  width: 50%;\n  padding: 10px;\n"]);return Q=function(){return e},e}function V(){var e=Object(i.a)(["\n  display: flex;\n  flex-wrap: wrap;\n  margin: -10px -10px 40px;\n"]);return V=function(){return e},e}var X=u.b.ul(V()),Z=u.b.li(Q()),ee=u.b.img(K()),te=u.b.span(q()),ne=u.b.button($(),(function(e){return e.success&&Object(u.a)(J())}),(function(e){return e.error&&Object(u.a)(D())}),(function(e){return e.played&&Object(u.a)(B())})),re=function(e){var t=e.tracks,n=e.selected,c=Object(r.useContext)(H).dispatch,o=Object(r.useState)(!1),i=Object(E.a)(o,2),u=i[0],l=i[1],s=Object(r.useState)(""),f=Object(E.a)(s,2),d=f[0],p=f[1];Object(r.useEffect)((function(){l(!1),p("")}),[n]);return a.a.createElement(a.a.Fragment,null,a.a.createElement(X,null,t.map((function(e){var t=e.id,r=e.album,o=e.name,i=u&&t===d&&d===n,s=u&&t===d&&d!==n,f=u&&t!==d&&t===n;return a.a.createElement(Z,{key:"track_".concat(t)},a.a.createElement(ne,{success:i,error:s,played:f,onClick:function(){return e=t,l(!0),p(e),void c(e===n?{type:"INCREMENT_POINTS"}:{type:"CLEAR_POINTS"});var e},disabled:u},a.a.createElement(ee,{src:r.images[1].url,alt:""}),a.a.createElement(te,null,o)))}))))};function ae(){var e=Object(i.a)(["\n      display: flex;\n      justify-content: space-between;\n    "]);return ae=function(){return e},e}function ce(){var e=Object(i.a)(["\n  color: #222;\n  margin: 0 0 20px;\n  font-family: Arial, Helvetica, sans-serif;\n\n  ","\n"]);return ce=function(){return e},e}var oe=u.b.h2(ce(),(function(e){return e.right&&e.right.length&&Object(u.a)(ae())})),ie=function(e){var t=e.children,n=e.right;return a.a.createElement(oe,{right:n},t,n&&n.length&&a.a.createElement("span",null,n))},ue=n(7),le=n.n(ue),se=n(14),fe={id:"",name:"",album:{images:[]},artists:[],preview_url:""},de="https://api.spotify.com/v1/recommendations",pe=function e(t,n,r,a){return r===a?t[0]:t[n].preview_url?t[n]:e(t,_(0,4),r+1,a)},be=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,a=Object(r.useState)("iddle"),c=Object(E.a)(a,2),o=c[0],i=c[1],u=Object(r.useState)([]),l=Object(E.a)(u,2),s=l[0],f=l[1],d=Object(r.useState)(fe),p=Object(E.a)(d,2),b=p[0],m=p[1],g=Object(r.useCallback)(Object(se.a)(le.a.mark((function r(){var a,c,o,u;return le.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e){r.next=2;break}return r.abrupt("return");case 2:return i("started"),f([]),a=[["limit",n],["seed_genres",t.join(",")],["min_acousticness",I(0,.5)],["min_danceability",I(0,.5)],["min_energy",I(0,.5)],["min_instrumentalness",I(0,.5)],["min_valence",I(0,.5)]],c=C(a),r.next=8,fetch("".concat(de,"?").concat(c),{method:"GET",headers:new Headers({Authorization:"Bearer ".concat(e||""),"Content-Type":"application/json"})});case 8:return o=r.sent,r.next=11,o.json();case 11:(u=r.sent).error?i("error"):(i("success"),f(u.tracks),m(pe(u.tracks,_(0,4),1,n)));case 13:case"end":return r.stop()}}),r)}))),[t,n,e]),v=function(){g()};return Object(r.useEffect)((function(){g()}),[g]),{state:o,tracks:s,selected:b,fetchMoreTracks:v}};function me(){var e=Object(i.a)(["\n  display: flex;\n  margin-left: -10px;\n  margin-right: -10px;\n\n  button {\n    margin-left: 10px;\n    margin-right: 10px;\n    width: 100%;\n  }\n"]);return me=function(){return e},e}var ge=u.b.div(me()),ve=function(){var e=Object(r.useContext)(H).state,t=S(),n=t.token,c=t.actions,o=N(),i=be(n,e.genres),u=i.state,l=i.tracks,s=i.selected,f=i.fetchMoreTracks;return Object(r.useEffect)((function(){"error"===u&&(c.saveToken(""),o())}),[u,c,o]),a.a.createElement(a.a.Fragment,null,a.a.createElement(ie,{right:"Pts: ".concat(e.points)},"Playing: "),s.id&&a.a.createElement(T,{src:s.preview_url,total:parseInt(e.difficulty,10)}),a.a.createElement(re,{tracks:l,selected:s.id}),a.a.createElement(ge,null,a.a.createElement(O,{onClick:f},"Next Track")))};function he(){var e=Object(i.a)(["\n      border: 1px solid var(--grey-color);\n      color: var(--grey-color);\n      background: transparent;\n    "]);return he=function(){return e},e}function je(){var e=Object(i.a)(["\n      background: var(--blue-color);\n      color: #fff;\n      font-weight: bold;\n    "]);return je=function(){return e},e}function Oe(){var e=Object(i.a)(["\n      width: 100%;\n    "]);return Oe=function(){return e},e}function Ee(){var e=Object(i.a)(["\n  padding: 10px;\n  margin: 5px;\n  font-size: 20px;\n  border: 0;\n  border-radius: 5px;\n\n  ","\n\n  ","\n\n  ","\n"]);return Ee=function(){return e},e}var ye=u.b.button(Ee(),(function(e){return e.fullWidth&&Object(u.a)(Oe())}),(function(e){return e.selected&&Object(u.a)(je())}),(function(e){return!e.selected&&Object(u.a)(he())})),xe=function(e){var t=e.id,n=e.title,r=e.selected,c=e.toggleItem,o=e.multiple,i=e.fullWidth,u=e.limit,l=e.totalSelected;return a.a.createElement(ye,{selected:r,fullWidth:i,onClick:function(){r?c(t,o):u?u&&l<u&&c(t,o):c(t,o)}},n)};function ke(){var e=Object(i.a)(["\n  display: flex;\n  flex-wrap: wrap;\n  margin: -5px;\n"]);return ke=function(){return e},e}function we(){var e=Object(i.a)(["\n  margin-bottom: 40px;\n"]);return we=function(){return e},e}var Te=function(e){var t=e.title,n=e.options,r=e.toggleItem,c=e.multiple,o=e.fullWidth,i=e.limit,u=n.filter((function(e){return e.selected})).length;return a.a.createElement(Se,null,a.a.createElement(ie,null,t),a.a.createElement(Ie,null,n.map((function(e){return a.a.createElement(xe,Object.assign({key:e.id,multiple:c,toggleItem:r,fullWidth:o,limit:i,totalSelected:u},e))}))))};Te.defaultProps={multiple:!1,fullWidth:!1};var Se=u.b.div(we()),Ie=u.b.div(ke()),_e=Te,Ce=function(e){return{type:"options/SET-ITEMS",payload:{items:e}}},Me=function(e,t){return function(e){return"options/SET-ITEMS"===e.type}(t)?{items:t.payload.items}:function(e){return"options/TOGGLE-ITEM"===e.type}(t)?t.payload.multiple?{items:e.items.map((function(e){return e.id===t.payload.id?Object(G.a)({},e,{selected:!e.selected}):e}))}:{items:e.items.map((function(e){return e.id===t.payload.id?Object(G.a)({},e,{selected:!0}):Object(G.a)({},e,{selected:!1})}))}:e},Ne=["blues","country","dance","disco","folk","forro","funk","gospel","hip-hop","house","indie","jazz","k-pop","metal","mpb","pagode","pop","punk","reggae","reggaeton","rock","samba","sertanejo","ska"],Ge=function(){var e=Object(r.useContext)(H).dispatch,t=Object(r.useReducer)(Me,{items:[]}),n=Object(E.a)(t,2),c=n[0],o=n[1],i=Object(r.useReducer)(Me,{items:[]}),u=Object(E.a)(i,2),l=u[0],s=u[1],f=S().token;Object(r.useEffect)((function(){o(Ce(Ne.map((function(e){return{id:e,title:e,selected:!1}})))),s(Ce([{id:"15",title:"Easy",selected:!1},{id:"10",title:"Medium",selected:!0},{id:"5",title:"Hard",selected:!1}]))}),[f]);var d=function(e){return function(t,n){e(function(e,t){return{type:"options/TOGGLE-ITEM",payload:{id:e,multiple:t}}}(t,n))}};return a.a.createElement(a.a.Fragment,null,a.a.createElement(_e,{title:"Select the genres you want to guess",options:c.items,toggleItem:d(o),limit:3,multiple:!0}),a.a.createElement(_e,{title:"Select the difficulty",toggleItem:d(s),options:l.items}),a.a.createElement(O,{onClick:function(){e(function(e){return{type:"SET_GENRES",payload:{genres:e}}}(c.items.filter((function(e){return e.selected})).map((function(e){return e.id})))),e({type:"SET_DIFFICULTY",payload:{difficulty:l.items.filter((function(e){return e.selected}))[0].id}}),e(L("PLAYING"))}},"Start Game"))},Pe=function(){var e=N(),t=Object(r.useContext)(H).dispatch,n=S(),c=n.token,o=n.actions,i=o.readToken,u=o.saveToken;Object(r.useEffect)((function(){var e=window.location.hash;e&&(u(e.replace("#","").split("&")[0].split("=")[1]),t(L("SETTING_UP")))}),[t,u]);return a.a.createElement(a.a.Fragment,null,a.a.createElement(O,{size:"lg",onClick:function(){c||i()?t(L("SETTING_UP")):e()},block:!0},"Start Game"))};function ze(){var e=Object(i.a)(["\n  width: 100%;\n  max-width: 500px;\n  margin: 0 auto;\n  padding: 30px 30px 40px;\n  display: flex;\n  flex-direction: column;\n"]);return ze=function(){return e},e}function Ae(){var e=Object(i.a)(["\n  width: 100vw;\n  height: 100vh;\n"]);return Ae=function(){return e},e}var Fe=u.b.div(Ae()),Re=u.b.div(ze()),We=function(){var e=Object(r.useContext)(H).dispatch,t=S().actions.saveToken;Object(r.useEffect)((function(){var n=window.location.hash;n&&(t(n.replace("#","").split("&")[0].split("=")[1]),e(L("SETTING_UP")),window.history.pushState("",document.title,window.location.pathname+window.location.search))}),[e,t]);var n=Object(r.useContext)(H).state;return a.a.createElement(a.a.Fragment,null,a.a.createElement(Fe,null,a.a.createElement(Re,null,"INIT"===n.gameState&&a.a.createElement(p,null),"PLAYING"===n.gameState?a.a.createElement(ve,null):function(e){return"SETTING_UP"===e}(n.gameState)?a.a.createElement(Ge,null):a.a.createElement(Pe,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(Y,null,a.a.createElement(We,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[15,1,2]]]);
//# sourceMappingURL=main.783c6bb1.chunk.js.map